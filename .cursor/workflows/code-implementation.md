# コード実装ワークフロー

## 対話開始前の準備

### ✅ 開いておくファイル
- [ ] 実装対象のファイル（メイン）
- [ ] 関連するテストファイル
- [ ] 参考にする既存スクリプト（あれば）

### ✅ 閉じておくファイル
- [ ] ADR類
- [ ] ドキュメント類（実装に直接関係ないもの）

---

## 新規チャット開始

**推奨**: コード実装専用の新しいチャットを開始

**理由**: ドキュメント編集のコンテキストが混入しない

---

## 効率的なクエリパターン

### パターン1: ペルソナベース実装
```markdown
@.cursor/contexts/PERSONA_SYSTEM.md

ルナ（好奇心旺盛）の性格を反映した探索スクリプトを実装してください。
```

### パターン2: 既存コード参考
```markdown
@scripts/export_cursor_chat.py

上記のスクリプトと同様の構造で、{新機能}を実装してください。
```

### パターン3: 最小限のコンテキスト
```markdown
# ペルソナ参照が不要な場合

{技術的要件の説明}

上記の要件に従って実装してください。
```

---

## ❌ 避けるべきパターン

### 非効率なパターン1: 不要なコンテキスト
```markdown
❌ @.cursor/contexts/ADR_GUIDELINES.md  # 実装には不要
❌ @.cursor/contexts/HIERARCHY_RULES.md  # 実装には不要

コードを実装してください
```

### 非効率なパターン2: ペルソナの過度な参照
```markdown
❌ @.cursor/contexts/PERSONA_SYSTEM.md
❌ @.cursor/contexts/PSYCHOLOGY_BACKGROUND.md

単純なバグ修正をしてください

→ バグ修正にペルソナ理解は不要
```

---

## 実装後のチェックリスト

- [ ] **コメント**: 日本語コメント（プロジェクトオーナーの母語）
- [ ] **ペルソナ反映**: 必要に応じてペルソナの性格を反映
- [ ] **テスト**: 動作確認
- [ ] **Git add**: `git add` のみ実行（コミットは承認後）
- [ ] **ユーザー確認**: 「コミットしてもよろしいですか？」と確認

---

## トークン消費の目安

| シナリオ | トークン数 | 備考 |
|---|---:|---|
| ペルソナベース実装 | ~1,500 | コアルール + PERSONA_SYSTEM |
| 既存コード参考 | ~2,000 | コアルール + 既存スクリプト |
| 最小限実装 | ~500 | コアルールのみ |

**Phase 1実施前**: 約10,000トークン

---

**作成日**: 2025-11-02

